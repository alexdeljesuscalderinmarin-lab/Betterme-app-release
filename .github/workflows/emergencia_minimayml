name: EMERGENCIA - Código Mínimo

on: workflow_dispatch

jobs:
  build:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      
      - name: Crear main.dart temporal SIN Firebase
        run: |
          cat > lib/main_temp.dart << 'EOF'
          import 'package:flutter/material.dart';
          import 'package:flutter_dotenv/flutter_dotenv.dart';
          import 'package:hive_flutter/hive_flutter.dart';
          
          void main() async {
            WidgetsFlutterBinding.ensureInitialized();
            await dotenv.load(fileName: '.env');
            await Hive.initFlutter();
            
            runApp(const MaterialApp(
              home: Scaffold(
                body: Center(child: Text('✅ BetterMe FUNCIONANDO')),
              ),
            ));
          }
          EOF

      - name: Build APK mínimo
        run: flutter build apk --release --target=lib/main_temp.dart

      - name: Upload APK mínimo
        uses: actions/upload-artifact@v4
        with:
          name: betterme-minimo
          path: build/app/outputs/flutter-apk/app-release.apk
